## THIS FILE WAS GENERATED BY MIB2SCHEMA
## For attributes containing printable ASCII
## characters, you may add a format string
## specification in the attribute characteristics
## line
## As described in RFC 1157, some agents cannot
## accept messages whose length exceeds 484 octets
## For those groups whose var-bind list has many
## entries, you may split them up into different
## var-bind lists
proxy CISCO-PORT-STORM-CONTROL-MIB
description "CISCO-PORT-STORM-CONTROL-MIB agent"
serial 2
rpcid 100122
(

## Enumerated Type Definitions

	enum	cpscTrafficTypeE (
	   1	"broadcast"
	   2	"multicast"
	   3	"unicast"
	   4	"all"
	)

	enum	cpscActionE (
	   1	"filter"
	   2	"shutdown"
	)

	enum	cpscNotificationControlE (
	   1	"none"
	   2	"stormOccurred"
	   3	"stormCleared"
	   4	"both"
	)

	enum	cpscStatusE (
	   1	"inactive"
	   2	"forwarding"
	   3	"trafficTypeFiltered"
	   4	"allTrafficFiltered"
	   5	"shutdown"
	)

	enum	cpscHistoryTrafficTypeE (
	   1	"broadcast"
	   2	"multicast"
	   3	"unicast"
	   4	"all"
	)


## Group and Table Declarations

	group	cpscConfigObjects
	description "(null)"
	characteristics "-K NONE"
	(
		readwrite int	cpscNotificationThreshold
		description 	"The value of object controls the global rate of storm
        control notifications generated by an entity per minute. 
        
        A value of 0 indicates no limit, and the entity will
        generate notifications for each storm event as governed by
        the cpscNotificationControl for a given interface."
		characteristics "-N cpscNotificationThreshold -O 1.3.6.1.4.1.9.9.362.1.1.3 -T INTEGER -A RW -X equal -F 0"

	)

	table	cpscThresholdTable
	description "A table of storm control threshold configuration entries."
	characteristics "-K ONE"
	(
		notaccessible enum cpscTrafficTypeE	cpscTrafficType
		description 	"This object identifies a particular traffic type
        for which a management station desires to configure
        storm control on the given interface (which is identified
        by its ifIndex)."
		characteristics "-N cpscTrafficType -O 1.3.6.1.4.1.9.9.362.1.1.1.1.1 -T INTEGER -A NA -X equal -F 0"

		readwrite int	cpscUpperThreshold
		description 	"This object represents the upper threshold of total
        amount of a particular traffic type that can be seen
        on a given interface, after which a storm event is
        declared and storm control action is taken.
        
        The value represents the traffic as a percentage of
        total bandwidth of the interface, in units of 0.01 %.
        
        For example, if a management station sets the value of
        cpscUpperThreshold.3.1 as 4000, it means the 
        following:
            a) storm control is enabled on the interface with 
               ifIndex = 3 for broadcast (1) packets
            b) if the broadcast traffic received per second
               on the interface is more than (4000*0.01 = 40%) of
               the total interface bandwidth, then the system will
               take storm control actions, as indicated by
               cpscAction.3 .
        
        It should be noted that setting the upper threshold value
        to anything other than 100% results in storm control being
        automatically enabled on the given interface, for the
        given traffic type.
        
        An implementation may not be able to support different
        threshold values for different traffic types, in which
        case changing the value for one traffic type will 
        automatically result in the threshold value for other
        types also modified.
        
        The default value of this object is implementation-
        dependent."
		characteristics "-N cpscUpperThreshold -O 1.3.6.1.4.1.9.9.362.1.1.1.1.2 -T INTEGER -A RW -X equal -F 0"

		readwrite int	cpscLowerThreshold
		description 	"This object represents the lower threshold of total
        amount of a particular traffic type.
        
        When a filter action (see cpscAction) is
        in effect on an interface because of a previous storm 
        event, the value of this object determines when the 
        system will stop the filter action. 
        
        The value represents traffic as percent of total bandwidth
        of the interface, in units of 0.01 %.
        For example, if a broadcast(1) storm occurred on an 
        interface with ifIndex 3, and the value of 
        cpscLowerThreshold.3.1 is 2500 (25%), then 
        the system will stop filtering broadcast traffic on that
        interface if it drops below 25% of the total bandwidth.
        
        This value will be ignored if a shutdown action is 
        configured. The value of this object must be
        equal to or less than the value of the upper threshold
        specified by cpscUpperThreshold for the same entry.
        
        The default value of this object is implementation-
        dependent.
        
        On platforms that only support one threshold level for 
        this traffic type and interface,this object is read-only
        and always has the same value of  the corresponding 
        cpscUpperThreshold for the same entry."
		characteristics "-N cpscLowerThreshold -O 1.3.6.1.4.1.9.9.362.1.1.1.1.3 -T INTEGER -A RW -X equal -F 0"

	)

	table	cpscActionTable
	description "A table of storm control action entries."
	characteristics "-K ???"
	(
		readwrite enum cpscActionE	cpscAction
		description 	"This object represents the storm control action
        taken when the traffic of a particular type exceeds
        the configured upper threshold values."
		characteristics "-N cpscAction -O 1.3.6.1.4.1.9.9.362.1.1.2.1.1 -T INTEGER -A RW -X equal -F 0"

		readwrite enum cpscNotificationControlE	cpscNotificationControl
		description 	"This object controls when a storm control notification
        will be generated.
        
        If the object is set to none(1), no notifications will
        be generated.
        
        A notification will be generated when a storm event is
        detected or cleared when the object is set to
        stormOccurred(2) or stormCleared(3) respectively.
        
        If the object is set to both(4), a notification will be
        generated both when a storm event is detected and
        cleared. 
        
        NOTE:
            a) The default value of this object is none(1).
            b) Irrespective of the value of this object, the
            value of the global object cpscNotificationThreshold
            controls whether or not a notification will be
            generated at a given point."
		characteristics "-N cpscNotificationControl -O 1.3.6.1.4.1.9.9.362.1.1.2.1.2 -T INTEGER -A RW -X equal -F 0"

	)

	table	cpscStatusTable
	description "A table of storm control status entries."
	characteristics "-K ???"
	(
		readonly enum cpscStatusE	cpscStatus
		description 	"This object identifies the status of storm control
        on the interface (identified by ifIndex) corresponding
        to a particular traffic type (identified by    
        cpscTrafficType).
        
        A value of inactive indicates that no storm control
        has been enabled on the interface for the traffic type."
		characteristics "-N cpscStatus -O 1.3.6.1.4.1.9.9.362.1.2.1.1.1 -T INTEGER -A RO -X equal -F 0"

		readonly int	cpscCurrentLevel
		description 	"This object identifies the current level of traffic of
        a particular type on a given interface, as a percentage
        of the total interface bandwidth.
        
        When storm control is inactive, the value is 10000,
        indicating the maximum level (100% of the particular
        traffic type is allowed to be received)."
		characteristics "-N cpscCurrentLevel -O 1.3.6.1.4.1.9.9.362.1.2.1.1.2 -T INTEGER -A RO -X equal -F 0"

		readonly counter	cpscSuppressedPacket
		description 	"This object represents the total number of packets
        of a particular traffic type that have been suppressed
        on a given interface by storm control filter action."
		characteristics "-N cpscSuppressedPacket -O 1.3.6.1.4.1.9.9.362.1.2.1.1.3 -T COUNTER -A RO -X equal -F 0"

	)

	table	cpscHistoryTable
	description "A conceptual table to represent the history
        of storm events on an interface.
        
        Management station can use this to get 
        information about the timeline of storm events as
        to when each event occurred, and when it ended."
	characteristics "-K TWO"
	(
		notaccessible enum cpscHistoryTrafficTypeE	cpscHistoryTrafficType
		description 	"The traffic type corresponding to this storm history
        entry."
		characteristics "-N cpscHistoryTrafficType -O 1.3.6.1.4.1.9.9.362.1.2.2.1.1 -T INTEGER -A NA -X equal -F 0"

		notaccessible int	cpscHistoryIndex
		description 	"A number that uniquely identifies one storm control
        history entry for a given interface. The index starts
        at 1 and increases by 1. 
        
        Although this MIB specification stipulates a maximum of 
        1K entries, the actual maximum number of history entries
        returned per interface is implementation-dependent.
        
        When the value of this index reaches the actual maximum 
        number of entries supported by an implementation, it will
        wrap around to 1."
		characteristics "-N cpscHistoryIndex -O 1.3.6.1.4.1.9.9.362.1.2.2.1.2 -T INTEGER -A NA -X equal -F 0"

		readonly timeticks	cpscHistoryStartTime
		description 	"The value of sysUpTime when the storm event was declared
        on the interface for the particular traffic type, and 
        storm control measures were taken."
		characteristics "-N cpscHistoryStartTime -O 1.3.6.1.4.1.9.9.362.1.2.2.1.3 -T TIMETICKS -A RO -X equal -F 0"

		readonly timeticks	cpscHistoryEndTime
		description 	"The value of sysUpTime when the storm ceased to exist
        and the interface was set to its previous normal state.
        
        If the interface was shutdown due to user configuration,
        then the value will be equal to the value of sysUpTime 
        when the interface was shutdown.
        
        If the storm event continues to persist when this object
        is queried, the value returned will be 0."
		characteristics "-N cpscHistoryEndTime -O 1.3.6.1.4.1.9.9.362.1.2.2.1.4 -T TIMETICKS -A RO -X equal -F 0"

	)

agenterrors (
	1	"cannot dispatch request"
	2	"select(2) failed"
	3	"sendto(2) failed"
	4	"recvfrom(2) failed"
	5	"no response from system"
	6	"response too big"
	7	"missing attribute"
	8	"bad attribute type"
	9	"cannot get sysUpTime"
	10	"sysUpTime type bad"
	11	"unknown SNMP error"
	12	"bad variable value"
	13	"variable is read only"
	14	"general error"
	15	"cannot make request PDU"
	16	"cannot make request varbind list"
	17	"cannot parse response PDU"
	18	"request ID - response ID mismatch"
	19	"string contains non-displayable characters"
	20	"cannot open schema file"
	21	"cannot parse schema file"
	22	"cannot open host file"
	23	"cannot parse host file"
	24	"attribute unavailable for set operations"
             )
)


## End of Agent Definitions
