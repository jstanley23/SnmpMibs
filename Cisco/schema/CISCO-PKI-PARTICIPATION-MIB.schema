## THIS FILE WAS GENERATED BY MIB2SCHEMA
## For attributes containing printable ASCII
## characters, you may add a format string
## specification in the attribute characteristics
## line
## As described in RFC 1157, some agents cannot
## accept messages whose length exceeds 484 octets
## For those groups whose var-bind list has many
## entries, you may split them up into different
## var-bind lists
proxy CISCO-PKI-PARTICIPATION-MIB
description "CISCO-PKI-PARTICIPATION-MIB agent"
serial 2
rpcid 100122
(

## Enumerated Type Definitions

	enum	cpkiRSAKeyPairSizeE (
	   1	"rsa512"
	   2	"rsa768"
	   3	"rsa1024"
	   4	"rsa1536"
	   5	"rsa2048"
	)

	enum	cpkiRSAKeyPairExportableE (
	   1	"true"
	   2	"false"
	)

	enum	cpkiRSAKeyPairStorageTypeE (
	   1	"other"
	   2	"volatile"
	   3	"nonVolatile"
	   4	"permanent"
	   5	"readOnly"
	)

	enum	cpkiRSAKeyPairConfigRowStatusE (
	   1	"active"
	   2	"notInService"
	   3	"notReady"
	   4	"createAndGo"
	   5	"createAndWait"
	   6	"destroy"
	)

	enum	cpkiActionE (
	   1	"noop"
	   2	"caauth"
	   3	"cadelete"
	   4	"certreq"
	   5	"certimport"
	   6	"certdelete"
	   7	"pkcs12import"
	   8	"pkcs12export"
	   9	"certconfirm"
	   10	"certnoconfirm"
	   11	"forcecertdelete"
	   12	"crlimport"
	   13	"crldelete"
	)

	enum	cpkiLastActionE (
	   1	"noop"
	   2	"caauth"
	   3	"cadelete"
	   4	"certreq"
	   5	"certimport"
	   6	"certdelete"
	   7	"pkcs12import"
	   8	"pkcs12export"
	   9	"certconfirm"
	   10	"certnoconfirm"
	   11	"forcecertdelete"
	   12	"crlimport"
	   13	"crldelete"
	)

	enum	cpkiLastActionResultE (
	   1	"none"
	   2	"success"
	   3	"failed"
	   4	"inProgress"
	   5	"needConfirm"
	)

	enum	cpkiTrustPointStorageTypeE (
	   1	"other"
	   2	"volatile"
	   3	"nonVolatile"
	   4	"permanent"
	   5	"readOnly"
	)

	enum	cpkiTrustPointConfigRowStatusE (
	   1	"active"
	   2	"notInService"
	   3	"notReady"
	   4	"createAndGo"
	   5	"createAndWait"
	   6	"destroy"
	)


## Group and Table Declarations

	table	cpkiRSAKeyPairTable
	description "A list of RSA key-pair entries."
	characteristics "-K ???"
	(
		notaccessible octet[64]	cpkiRSAKeyPairName
		description 	"The unique name or label of key-pair."
		characteristics "-N cpkiRSAKeyPairName -O 1.3.6.1.4.1.9.9.505.1.1.1.1.1 -T STRING -A NA -X equal -F 0"

		readonly gauge	cpkiRSAKeyPairId
		description 	"A unique identification nubmer of the RSA key-pair.
        This is included to support ordered lists of RSA
        key-pairs when needed. One such scenario where such
        ordered list may be needed is for per application
        configuration of key-pairs."
		characteristics "-N cpkiRSAKeyPairId -O 1.3.6.1.4.1.9.9.505.1.1.1.1.2 -T GAUGE -A RO -X equal -F 0"

		readwrite enum cpkiRSAKeyPairSizeE	cpkiRSAKeyPairSize
		description 	"The size of the key.
        
        The following modulus sizes are defined:
        512-bit, 768-bit, 1024-bit, 1536-bit and 2048-bit.
        Once created, the size cannot be changed. After
        key-pair has been deleted through row deletion,
        the entry can be created again with another size."
		characteristics "-N cpkiRSAKeyPairSize -O 1.3.6.1.4.1.9.9.505.1.1.1.1.3 -T INTEGER -A RW -X equal -F 0"

		readonly octet[255]	cpkiRSAPvtKeyFileName
		description 	"The name of the file storing the RSA private key.
        This filename is automatically generated from the
        key-pair name. It is a unix style '/' seperated string
        representing the absolute path of the file in the
        file system of the device"
		characteristics "-N cpkiRSAPvtKeyFileName -O 1.3.6.1.4.1.9.9.505.1.1.1.1.4 -T STRING -A RO -X equal -F 0"

		readwrite enum cpkiRSAKeyPairExportableE	cpkiRSAKeyPairExportable
		description 	"The key-pair is exportable through the 'exportpkcs12'
        PKI support action. Once created, the exportable flag
        value cannot be changed. After key-pair has been
        deleted through row deletion, the entry can be created 
        again with another value for the exportable flag"
		characteristics "-N cpkiRSAKeyPairExportable -O 1.3.6.1.4.1.9.9.505.1.1.1.1.5 -T INTEGER -A RW -X equal -F 0"

		readwrite enum cpkiRSAKeyPairStorageTypeE	cpkiRSAKeyPairStorageType
		description 	"The storage type for this conceptual row."
		characteristics "-N cpkiRSAKeyPairStorageType -O 1.3.6.1.4.1.9.9.505.1.1.1.1.6 -T INTEGER -A RW -X equal -F 0"

		readwrite enum cpkiRSAKeyPairConfigRowStatusE	cpkiRSAKeyPairConfigRowStatus
		description 	"The conceptual row status of the key-pair entry.
        Deleting an entry through row delete will fail if the
        entry is being pointed to from an instance from
        cpkiTrustPointTable.
        
        The objects in the entry may not be modified while
        the value of this object is active(1).
        
        An attempt to set these objects while the value of
        cpkiRSAKeyPairConfigRowStatus is active(1) will
        result in an inconsistentValue error."
		characteristics "-N cpkiRSAKeyPairConfigRowStatus -O 1.3.6.1.4.1.9.9.505.1.1.1.1.7 -T INTEGER -A RW -X equal -F 0"

	)

	table	cpkiTrustPointTable
	description "A list of trustpoint, associated key-pair,
        certificates and revocation checking
        configuration entries.
        
        The table also provides control, actions, current
        operating state information and last action result
        information for the certificate work-flow if being 
        carried out using the PKI support actions."
	characteristics "-K ???"
	(
		notaccessible octet[64]	cpkiTrustPointName
		description 	"The unique name or label of a trustpoint."
		characteristics "-N cpkiTrustPointName -O 1.3.6.1.4.1.9.9.505.1.1.2.1.1 -T STRING -A NA -X equal -F 0"

		readonly gauge	cpkiTrustPointId
		description 	"A unique identification number of the trustpoint.
        This is included to support ordered lists of trustpoints
        when needed. One such scenario where such ordered list
        may be needed is for per application configuration of
        trustpoints for certificate selection"
		characteristics "-N cpkiTrustPointId -O 1.3.6.1.4.1.9.9.505.1.1.2.1.2 -T GAUGE -A RO -X equal -F 0"

		readwrite octet[64]	cpkiKeyPairName
		description 	"The name of the associated key-pair from a key-pair
        table. If a key-pair is not yet associated, the value
        of this object will be a zero length string.
        
        If a key-pair is already associated, it can be modified
        only if the identity certificate is absent as indicated
        by a non-zero length string value of the object
        cpkiIssuerCertFileName. This is because of the fact that
        the identity certificate is certifying this key-pair."
		characteristics "-N cpkiKeyPairName -O 1.3.6.1.4.1.9.9.505.1.1.2.1.3 -T STRING -A RW -X equal -F 0"

		readonly octet[255]	cpkiIdCertFileName
		description 	"The name of the file storing the identity
        certificate. It is a unix style '/' seperated string
        representing the absolute path of the file in the
        file system of the device. If there is no identity
        certificate obtained as yet, the value of this object
        will be a zero length string. 
        
        This object gets its non-zero length string value
        after a successful 'certimport' or 'pkcs12import'
        PKI support action triggered on the object cpkiAction.
        
        This object gets set to zero length string when the
        identity certificate is deleted through a successful
        'certdelete' action triggered on the object
        cpkiAction."
		characteristics "-N cpkiIdCertFileName -O 1.3.6.1.4.1.9.9.505.1.1.2.1.4 -T STRING -A RO -X equal -F 0"

		readonly octet[255]	cpkiIdCertSubjectName
		description 	"The subject name of the identity certificate.
        If there is no certificate (as indicated by a zero
        length string value of the object cpkiIdCertFileName)
        or no subject name in the certificate, the value of
        this object will be a zero length string."
		characteristics "-N cpkiIdCertSubjectName -O 1.3.6.1.4.1.9.9.505.1.1.2.1.5 -T STRING -A RO -X equal -F 0"

		readonly octet[255]	cpkiIdCertSerialNum
		description 	"The serial number of the identity certificate.  
        If there is no certificate (as indicated by a zero
        length string value of the object cpkiIdCertFileName),
        the value of this object will be a zero length string."
		characteristics "-N cpkiIdCertSerialNum -O 1.3.6.1.4.1.9.9.505.1.1.2.1.6 -T STRING -A RO -X equal -F 0"

		readonly octet[11]	cpkiIdCertStartDate
		description 	"The time when the identity certificate starts to be
        valid, corresponding to the notBefore field in the
        certificate. 
        
        If there is no certificate (as indicated by a zero
        length string value of the object cpkiIdCertFileName),
        the value of this object will be a zero length string."
		characteristics "-N cpkiIdCertStartDate -O 1.3.6.1.4.1.9.9.505.1.1.2.1.7 -T STRING -A RO -X equal -F 0"

		readonly octet[11]	cpkiIdCertEndDate
		description 	"The time when the identity certificate validity ends,
        corresponding to the notAfter field in the
        certificate. 
        
        If there is no certificate (as indicated by the zero
        length string value of the object cpkiIdCertFileName),
        the value of this object will be a zero length string."
		characteristics "-N cpkiIdCertEndDate -O 1.3.6.1.4.1.9.9.505.1.1.2.1.8 -T STRING -A RO -X equal -F 0"

		readonly octet[255]	cpkiIdCertFingerPrint
		description 	"The MD5 fingerprint of the identity certificate in
        HEX string format.
        
        If there is no certificate (as indicated by a zero
        length string value of the object cpkiIdCertFileName),
        the value of this object will be a zero length string."
		characteristics "-N cpkiIdCertFingerPrint -O 1.3.6.1.4.1.9.9.505.1.1.2.1.9 -T STRING -A RO -X equal -F 0"

		readonly octet[255]	cpkiIssuerCertFileName
		description 	"The name of the file storing the issuer certificate.
        It is a unix style '/' seperated string representing
        the absolute path of the file in the file system of
        the device. If there is no issuer certificate obtained
        yet, the value of this object will be a zero length
        string.
        
        This object gets its non-zero length string value
        after a successful 'caauth' PKI support action
        triggered on the object cpkiAction.
        
        This object gets set to zero length string when the
        issuer certificate is deleted through a successful
        'cadelete' action triggered on the object
        cpkiAction."
		characteristics "-N cpkiIssuerCertFileName -O 1.3.6.1.4.1.9.9.505.1.1.2.1.10 -T STRING -A RO -X equal -F 0"

		readonly octet[255]	cpkiIssuerCertSubjectName
		description 	"The issuer name (subject name in issuer certificate
        which will be the same as the issuer name in the
        identity certificate if present).
        
        If there is no certificate (as indicated by a zero
        length string value of the object cpkiIssuerCertFileName),
        the value will be a zero length string."
		characteristics "-N cpkiIssuerCertSubjectName -O 1.3.6.1.4.1.9.9.505.1.1.2.1.11 -T STRING -A RO -X equal -F 0"

		readonly octet[255]	cpkiIssuerCertSerialNum
		description 	"The serial number of the issuer certificate.
        
        If there is no certificate (as indicated by a zero
        length string value of the object
        cpkiIssuerCertFileName), the value will be a zero
        length string."
		characteristics "-N cpkiIssuerCertSerialNum -O 1.3.6.1.4.1.9.9.505.1.1.2.1.12 -T STRING -A RO -X equal -F 0"

		readonly octet[11]	cpkiIssuerCertStartDate
		description 	"The time when the issuer certificate starts to be
        valid, corresponding to the notBefore field in the
        certificate.
        
        If there is no certificate (as indicated by a zero
        length string value of the object
        cpkiIssuerCertFileName), the value will be a zero
        length string."
		characteristics "-N cpkiIssuerCertStartDate -O 1.3.6.1.4.1.9.9.505.1.1.2.1.13 -T STRING -A RO -X equal -F 0"

		readonly octet[11]	cpkiIssuerCertEndDate
		description 	"The time when the issuer certificate validity ends,
        corresponding to the notAfter field on in the
        certificate.
        
        If there is no certificate (as indicated by a zero
        length string value of the object
        cpkiIssuerCertFileName), the value will be a zero
        length string."
		characteristics "-N cpkiIssuerCertEndDate -O 1.3.6.1.4.1.9.9.505.1.1.2.1.14 -T STRING -A RO -X equal -F 0"

		readonly octet[255]	cpkiIssuerCertFingerPrint
		description 	"The MD5 fingerprint of the issuer's certificate in
        HEX string format.
        
        If there is no certificate (as indicated by a
        zero length string value of cpkiIssuerCertFileName),
        the value of this object will be a zero length string."
		characteristics "-N cpkiIssuerCertFingerPrint -O 1.3.6.1.4.1.9.9.505.1.1.2.1.15 -T STRING -A RO -X equal -F 0"

		readwrite octet[16]	cpkiRevokeCheckMethods
		description 	"Revocation checking methods list which is an ordered
        list of certificate revocation checking methods to be
        employed while verifying peer certificates issued by
        the CA corresponding to this trust point entry.
        
        The value of this object is a ordered list of one or
        more 1-octet values, where each 1-octet value
        corresponds to a method in the revocation checking method
        enumeration:
        
        none (1)         - No revocation status checking needed;
                         instead consider the certificate as
                         not revoked.
        
        crl  (2)         - Use CRL for checking the revocation
                         status of certificates.
        
        ocsp (3)         - Use OCSP for checking the revocation
                         status of certificates.
        
        If 'none' occures in the list, it should be the last value.
        The octets after the last value in the ordered list
        should be zero octets.
        
        The order in which the revocation checking methods
        occur within the value of this object determines
        the order the revocation checking methods are attempted
        during the verification of a peer certificate.
        
        The default value of this object (after row creation)
        contains only the revocation checking method 'crl'."
		characteristics "-N cpkiRevokeCheckMethods -O 1.3.6.1.4.1.9.9.505.1.1.2.1.16 -T STRING -A RW -X equal -F 0"

		readwrite octet[255]	cpkiOCSPurl
		description 	"The contact http url of the external OCSP server for 
        certificate revocation checking using OCSP protocol.
        
        The default value of this object (after row creation)
        is a zero length string"
		characteristics "-N cpkiOCSPurl -O 1.3.6.1.4.1.9.9.505.1.1.2.1.17 -T STRING -A RW -X equal -F 0"

		readwrite enum cpkiActionE	cpkiAction
		description 	"The PKI support action to be triggered for this
        trustpoint entry.
        
        The PKI support actions are steps in the certificate
        work-flow used to facilitate the configuration of the
        RSAkey-pair, identity certificate and CA certificates
        in a trustpoint. A PKI support action is triggered by
        setting this object to the corresponding value as defined
        in TC CiscoPkiAction. The value of this object and the
        values of the objects cpkiActionUrl and cpkiActionPassword
        are interpreted and applied together as single action
        trigger. All thease actions operate over the trustpoint
        and modify appropriate columns in the entry.
        
        An attempt to set this object when the value of the
        object cpkiActionResult is 'inProgress' will result in an
        inconsistentValue error.
        
        The work-flow nature of certificate operations requires
        that the trustpoint entry already exists. Some of the
        operation requires that some other previous operations
        are already performed successfully, as seen below.
        
        The following is a brief of each action semantics, its
        parameters and the result:
        
        'caauth' - This action is used to authenticate a CA and
        configure its CA certificate/chain in this trustpoint. This
        is generally the first step in a certificate work-flow.
        It requires the parameter objects cpkiActionUrl and
        cpkiActionPassword set with appropriate values. The CA
        certificate/chain being installed should be available in
        PEM fromat in a file on bootflash. The filename is
        specified as 'bootflash:<filename>' as the value of the
        object cpkiActionUrl. On successful completion of the
        operation, the CA certificate fingerprint will be
        available as the value of the object
        cpkiIssuerCertFingerPrint and the value of the object
        cpkiLastActionResult will be 'needConfirm'. This action
        is to be followed up with a subsequent 'certconfirm' or
        'certnoconfirm' as explained later, to complete the CA
        authentication process.
        
        'cadelete' - This action is used to delete the CA
        certificate/chain from this trustpoint. On successful
        completion of the operation, the values of all issuer
        certificate related objects (cpkiIssuerCertFileName
        etc.) in this trustpoint entry will zero length strings.
        For this action to succeed, a CA certificate/chain should
        have been already configured through the 'caauth' action.
        
        'certreq' - This action is used to generate a pkcs#10
        certificate signing request (CSR) needed to obtain an
        identity certificate from the CA corresponding to this
        trustpoint entry. This entry should have a key-pair
        already associated (as indicated by non-zero value of
        cpkiKeyPairIndex in the entry). Also the CA certificate/
        chain should have been already configured through the
        'caauth' action. This action requires the parameter
        object cpkiActionPassword to be set with a password string
        which will be used as the 'challenge password' attribute
        in the CSR being created (the password being opional, it
        should be a zero length string if no password is being
        specified). On successful completion of the operation, the
        value of the object cpkiActionUrl will contain a file name
        string in the format 'bootflash:<filename>' which will
        contain the CSR generated in PEM format. This CSR has to be
        submitted to the CA to get the identity certificate. The
        process of submitting CSR to the CA and getting the identity
        certificate is a step not supported by this MIB currently.
        Once the identity certificate is obtained, it has to be
        installed in this trustpoint with a subsequent 'certimport'
        action explained next.
        
        'certimport' - This action is used to import in this
        trustpoint, an idenetity certificate obtained from the
        corresponding CA for an earlier CSR generated (previous
        operation 'certreq'). It requires that the identity
        certificate being installed be available in PEM fromat in a
        file on bootflash. The filename is specified  as
        'bootflash:<filename>' as the value of the object
        cpkiActionUrl. On successful completion of the operation,
        the values of all identity certificate related objects
        (cpkiIdCertFileName etc.) in this entry will get filled
        with the appropriate strings as per the corresponding
        attributes in the identity certificate.
        
        'certdelete' - This action is used to delete the identity
        certificate from this trustpoint. On successful completion
        of the operation, the values of all identity certificate
     "
		characteristics "-N cpkiAction -O 1.3.6.1.4.1.9.9.505.1.1.2.1.18 -T INTEGER -A RW -X equal -F 0"

		readwrite octet[255]	cpkiActionUrl
		description 	"The value of this object indicates the filename
        containig the input or output certificate data needed
        for the PKI support action being triggered on this entry.
        The filename should pe specified as 'bootflash:<filename>'
        and it should be available on bootflash or get created on
        bootflash depending upon the action being triggered. "
		characteristics "-N cpkiActionUrl -O 1.3.6.1.4.1.9.9.505.1.1.2.1.19 -T STRING -A RW -X equal -F 0"

		readwrite octet[64]	cpkiActionPassword
		description 	"The value of this object indicates the password
        required to perform the PKI support action being
        triggered. This password is required to be
        specified only for 'certreq', 'importpkcs12' and
        'exportpkcs12' actions.
        
        For security reasons, the value of this object, whenever
        it is retrieved by the management prototcol, is always
        the zero length string."
		characteristics "-N cpkiActionPassword -O 1.3.6.1.4.1.9.9.505.1.1.2.1.20 -T STRING -A RW -X equal -F 0"

		readonly enum cpkiLastActionE	cpkiLastAction
		description 	"The PKI support action attempted last. In otherwords,
        the value attempted to be set for cpkiAction object
        last. If no action has been triggered for the trustpoint
        after its creation, then retrieving the value of this
        object will return 'noop'."
		characteristics "-N cpkiLastAction -O 1.3.6.1.4.1.9.9.505.1.1.2.1.21 -T INTEGER -A RO -X equal -F 0"

		readonly enum cpkiLastActionResultE	cpkiLastActionResult
		description 	"The result of the execution of the last PKI support
        action (represented by the value of cpkiLastAction).
        When the value of this object is 'inProgress', an
        attempt to set the value of cpkiAction object will
        return inConsistentError."
		characteristics "-N cpkiLastActionResult -O 1.3.6.1.4.1.9.9.505.1.1.2.1.22 -T INTEGER -A RO -X equal -F 0"

		readonly octet[255]	cpkiLastActionFailureReason
		description 	"The failure reason description for the failed
        execution of PKI support action. If the object
        cpkiActionResult has the value 'failed', then
        this object contains the reason string as to why
        it failed.  Otherwise, the value of this object is
        a zero length string."
		characteristics "-N cpkiLastActionFailureReason -O 1.3.6.1.4.1.9.9.505.1.1.2.1.23 -T STRING -A RO -X equal -F 0"

		readwrite enum cpkiTrustPointStorageTypeE	cpkiTrustPointStorageType
		description 	"The storage type for this conceptual row."
		characteristics "-N cpkiTrustPointStorageType -O 1.3.6.1.4.1.9.9.505.1.1.2.1.24 -T INTEGER -A RW -X equal -F 0"

		readwrite enum cpkiTrustPointConfigRowStatusE	cpkiTrustPointConfigRowStatus
		description 	"The conceptual row status of the trustpoint entry.
        
        After row creation, the value of this object will
        become active(1) as there is no prerequisite of certain
        objects to be set to make this object active.
        
        The various read-only objects of the row can be
        populated only by means of the various PKI support
        actions attempted by setting the cpkiAction object
        with appropriate value.
        
        Except the read-only objects mentioned, all other
        objects of the entry can be modified when the row
        is active subject to the restrictions, if any,
        specified for each"
		characteristics "-N cpkiTrustPointConfigRowStatus -O 1.3.6.1.4.1.9.9.505.1.1.2.1.25 -T INTEGER -A RW -X equal -F 0"

	)

agenterrors (
	1	"cannot dispatch request"
	2	"select(2) failed"
	3	"sendto(2) failed"
	4	"recvfrom(2) failed"
	5	"no response from system"
	6	"response too big"
	7	"missing attribute"
	8	"bad attribute type"
	9	"cannot get sysUpTime"
	10	"sysUpTime type bad"
	11	"unknown SNMP error"
	12	"bad variable value"
	13	"variable is read only"
	14	"general error"
	15	"cannot make request PDU"
	16	"cannot make request varbind list"
	17	"cannot parse response PDU"
	18	"request ID - response ID mismatch"
	19	"string contains non-displayable characters"
	20	"cannot open schema file"
	21	"cannot parse schema file"
	22	"cannot open host file"
	23	"cannot parse host file"
	24	"attribute unavailable for set operations"
             )
)


## End of Agent Definitions
