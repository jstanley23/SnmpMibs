## THIS FILE WAS GENERATED BY MIB2SCHEMA
## For attributes containing printable ASCII
## characters, you may add a format string
## specification in the attribute characteristics
## line
## As described in RFC 1157, some agents cannot
## accept messages whose length exceeds 484 octets
## For those groups whose var-bind list has many
## entries, you may split them up into different
## var-bind lists
proxy CISCO-IP-URPF-MIB
description "CISCO-IP-URPF-MIB agent"
serial 2
rpcid 100122
(

## Enumerated Type Definitions

	enum	cipUrpfIpVersionE (
	   1	"ipv4"
	   2	"ipv6"
	)

	enum	cipUrpfIfIpVersionE (
	   1	"ipv4"
	   2	"ipv6"
	)

	enum	cipUrpfIfDropRateNotifyEnableE (
	   1	"true"
	   2	"false"
	)

	enum	cipUrpfIfNotifyDrHoldDownResetE (
	   1	"true"
	   2	"false"
	)

	enum	cipUrpfIfCheckStrictE (
	   1	"strict"
	   2	"loose"
	)

	enum	cipUrpfIfWhichRouteTableIDE (
	   1	"default"
	   2	"vrf"
	)


## Group and Table Declarations

	group	cipUrpfScalar
	description "(null)"
	characteristics "-K NONE"
	(
		readwrite int	cipUrpfDropRateWindow
		description 	"The window of time in the recent past over which the drop
         count used in the drop rate computation is collected. 
         This global value applies for the computation of all URPF 
         rates, global and per-interface. 
        
         Once the period over which computations have been 
         performed exceeds cipUrpfDropRateWindow, every time a 
         computation is performed, the window slides up to end 
         at the current time and start at cipUrpfDropRateWindow 
         seconds before. 
        
         The cipUrpfDropRateWindow must be greater than
         or equal to the interval between computations 
         (cipUrpfComputeInterval).
        
         Since the agent must save the drop count values
         for each compute interval in order to slide the window,
         the number of counts saved is the quotient of
         cipUrpfDropRateWindow divided by cipUrpfComputeInterval."
		characteristics "-N cipUrpfDropRateWindow -O 1.3.6.1.4.1.9.9.451.1.1.1 -T INTEGER -A RW -X equal -F 0"

		readwrite int	cipUrpfComputeInterval
		description 	"The time between rate computations. This global value 
         applies for the computation of all URPF rates, global
         and per-interface.
        
         When the value of cipUrpfComputeInterval is changed,
         the interval in-progress proceeds as though the value
         had not changed. The change will apply to the length
         of subsequent intervals.
        
         The cipUrpfComputeInterval must be less than or equal 
         to the cipUrpfDropRateWindow."
		characteristics "-N cipUrpfComputeInterval -O 1.3.6.1.4.1.9.9.451.1.1.2 -T INTEGER -A RW -X equal -F 0"

		readwrite int	cipUrpfDropNotifyHoldDownTime
		description 	"The minimum time between issuance of 
         cipUrpfIfDropRateNotify notifications for a 
         particular interface and packet forwarding type.
        
         Notifications are generated for each interface and
         packet forwarding type that exceeds the drop-rate. 
         When a Notify is sent because the drop-rate is 
         exceeded for a particular interface and forwarding
         type, the time specified by this object is used to 
         specify the minimum time that must elapse before 
         another Notify can be sent for that interface and
         forwarding type. The time is specified globally but 
         used individually."
		characteristics "-N cipUrpfDropNotifyHoldDownTime -O 1.3.6.1.4.1.9.9.451.1.1.3 -T INTEGER -A RW -X equal -F 0"

	)

	table	cipUrpfTable
	description "This table contains summary information for the
         managed device on URPF dropping."
	characteristics "-K ONE"
	(
		notaccessible enum cipUrpfIpVersionE	cipUrpfIpVersion
		description 	"Specifies the version of IP forwarding on an interface
         to which the table row URPF counts, rates, and
         configuration apply."
		characteristics "-N cipUrpfIpVersion -O 1.3.6.1.4.1.9.9.451.1.2.1.1.1 -T INTEGER -A NA -X equal -F 0"

		readonly counter	cipUrpfDrops
		description 	"Sum of dropped IP version cipUrpfIpVersion packets failing 
         a URPF check. This value is the sum of drops of packets 
         received on all interfaces of the managed device."
		characteristics "-N cipUrpfDrops -O 1.3.6.1.4.1.9.9.451.1.2.1.1.2 -T COUNTER -A RO -X equal -F 0"

		readonly gauge	cipUrpfDropRate
		description 	"The rate of packet drops of IP version cipUrpfIpVersion 
         packets due to URPF for the managed device. The 
         per-interface drop rate notification is issued on rates 
         exceeding a limit (rising rate). This dropping may 
         indicate an security attack on the network. To determine 
         whether the attack/event is over, the NMS must 
         consult the managed device. This object can be polled to 
         determine the recent drop rate for the managed device
         as a whole, in addition to querying particular interface 
         objects.
        
         This object is the average rate of dropping over the most 
         recent window of time. The rate is computed by dividing 
         the number of packets dropped over a window by the window 
         time in seconds. The window time is specified by 
         cipUrpfDropRateWindow. Each time the drop rate is computed, 
         and at system startup, a snapshot is taken of the latest 
         value of cipUrpfDrops. Subtracting from this the snapshot 
         of cipUrpfDrops at the start of the current window of time 
         gives the number of packets dropped.  The drop rate is 
         computed every cipUrpfComputeInterval seconds. As an 
         example, let cipUrpfDropRateWindow be 300 seconds,
         and cipUrpfComputeInterval 30 seconds. Every 30 seconds,
         the drop count five minutes previous is subtracted
         from the current drop count, and the result is divided
         by 300 to arrive at the drop rate.
        
         At device start-up, until the device has been up more than
         cipUrpfDropRateWindow, when drop rate is computed,
         the value of cipUrpfDrops is divided by the time the
         device has been up.
        
         After the device has been up for cipUrpfDropRateWindow,
         when drop rate is computed, the number of packet drops counted 
         from interval start time to the computation time is divided 
         by cipUrpfDropRateWindow.
        
         Changes to cipUrpfDropRateWindow are not reflected in this
         object until the next computation time.
        
         The rate from the  most recent computation is the value 
         fetched until the subsequent computation is performed."
		characteristics "-N cipUrpfDropRate -O 1.3.6.1.4.1.9.9.451.1.2.1.1.3 -T GAUGE -A RO -X equal -F 0"

	)

	table	cipUrpfIfMonTable
	description "This table contains information on URPF dropping on
         an interface."
	characteristics "-K ONE"
	(
		notaccessible enum cipUrpfIfIpVersionE	cipUrpfIfIpVersion
		description 	"Specifies the version of IP forwarding on an interface 
         to which the table row URPF counts, rates, and 
         configuration apply."
		characteristics "-N cipUrpfIfIpVersion -O 1.3.6.1.4.1.9.9.451.1.2.2.1.1 -T INTEGER -A NA -X equal -F 0"

		readonly counter	cipUrpfIfDrops
		description 	"The number of IP packets of version cipUrpfIfIpVersion
         failing the URPF check and dropped by the managed device
         on a particular interface.
        
         Discontinuities in the value of this variable can occur 
         at re-initialization of the management system, and at 
         other times as indicated by the values of 
         cipUrpfIfDiscontinuityTime."
		characteristics "-N cipUrpfIfDrops -O 1.3.6.1.4.1.9.9.451.1.2.2.1.2 -T COUNTER -A RO -X equal -F 0"

		readonly counter	cipUrpfIfSuppressedDrops
		description 	"The number of IP packets of version cipUrpfIfIpVersion 
         failing the URPF check but given a reprieve and not 
         dropped by the managed device. Depending on the 
         device configuration and capabilities, the following 
         cases may cause incrementing of the counter: 
         - if the managed device is configured to allow self-pings 
           and the managed device pings itself.
         - if the managed device is configured for loose URPF (if any
           interface has a route to the source), and the strict
           case fails while the loose case passes.
         - DHCP Request packets (src 0.0.0.0 dst 255.255.255.255) 
           will pass after initially being marked for drop.
         - RIP routing on unnumbered interfaces will pass after 
           initially being marked for drop.
         - multicast packets will pass after initially being marked 
           for drop
         - ACL's can be applied to permit packets after initially 
           being marked for drop.
        
         Discontinuities in the value of this variable can occur 
         at re-initialization of the management system, and at 
         other times as indicated by the values of 
         cipUrpfIfDiscontinuityTime."
		characteristics "-N cipUrpfIfSuppressedDrops -O 1.3.6.1.4.1.9.9.451.1.2.2.1.3 -T COUNTER -A RO -X equal -F 0"

		readonly gauge	cipUrpfIfDropRate
		description 	"The rate of packet drops of IP version cipUrpfIfIpVersion
         packets due to URPF on the interface. 
        
         This object is the average rate of dropping over the most 
         recent interval of time. The rate is computed by dividing
         the number of packets dropped over an interval by the 
         interval time in seconds. Each time the drop rate
         is computed, and at system startup, a snapshot is taken
         of the latest value of cipUrpfIfDrops. Subtracting from this
         the snapshot of cipUrpfIfDrops at the start of the current
         interval of time gives the number of packets dropped.
         The drop rate is computed every cipUrpfComputeInterval
         seconds.
        
         When drop rate is computed, if time since the creation of 
         a row in cipUrpfIfMonTable is less than 
         cipUrpfDropRateWindow, the value of cipUrpfIfDrops is 
         divided by the time since row was created.
        
         After the row has been in existence for 
         cipUrpfDropRateWindow, when drop rate is computed, the 
         number of packet drops counted on the interface from 
         interval start time to the computation time is divided 
         by cipUrpfDropRateWindow.
        
         Changes to cipUrpfDropRateWindow are not reflected in this
         object until the next computation time.
        
         The rate from the  most recent computation is the value 
         fetched until the subsequent computation is performed."
		characteristics "-N cipUrpfIfDropRate -O 1.3.6.1.4.1.9.9.451.1.2.2.1.4 -T GAUGE -A RO -X equal -F 0"

		readonly timeticks	cipUrpfIfDiscontinuityTime
		description 	"The value of sysUpTime on the most recent
         occasion at which this interface's  counters
         suffered  a discontinuity.
         If no such discontinuities have occurred
         since the last re-initialization of the
         local management subsystem, then this
         object contains a value of zero."
		characteristics "-N cipUrpfIfDiscontinuityTime -O 1.3.6.1.4.1.9.9.451.1.2.2.1.5 -T TIMETICKS -A RO -X equal -F 0"

	)

	table	cipUrpfVrfIfTable
	description "This table contains statistics information for interfaces
         performing URPF using VRF table to determine reachability."
	characteristics "-K ???"
	(
		readonly counter	cipUrpfVrfIfDrops
		description 	"The number of packets failing the URPF check for a VRF on 
         the interface and dropped by the managed device.
        
         Discontinuities in the value of this variable can occur 
         at re-initialization of the management system, and at 
         other times as indicated by the values of 
         cipUrpfVrfIfDiscontinuityTime."
		characteristics "-N cipUrpfVrfIfDrops -O 1.3.6.1.4.1.9.9.451.1.2.3.1.2 -T COUNTER -A RO -X equal -F 0"

		readonly timeticks	cipUrpfVrfIfDiscontinuityTime
		description 	"The value of sysUpTime on the most recent occasion at 
         which the URPF counters for this VRF on this interface 
         suffered  a discontinuity.  If no such discontinuities 
         have occurred since the last re-initialization of the
         local management subsystem, then this object contains a 
         value of zero."
		characteristics "-N cipUrpfVrfIfDiscontinuityTime -O 1.3.6.1.4.1.9.9.451.1.2.3.1.3 -T TIMETICKS -A RO -X equal -F 0"

	)

	table	cipUrpfIfConfTable
	description "This table contains statistics information on URPF on
         an interface."
	characteristics "-K ???"
	(
		readwrite enum cipUrpfIfDropRateNotifyEnableE	cipUrpfIfDropRateNotifyEnable
		description 	"This object specifies whether the system produces the 
         cipUrpfIfDropRateNotify notification as a result of URPF 
         dropping of version cipUrpfIfIpVersion IP packets on this 
         interface. A false value prevents such notifications from 
         being generated by this system."
		characteristics "-N cipUrpfIfDropRateNotifyEnable -O 1.3.6.1.4.1.9.9.451.1.3.1.1.1 -T INTEGER -A RW -X equal -F 0"

		readwrite gauge	cipUrpfIfNotifyDropRateThreshold
		description 	"When the calculated rate of URPF packet drops 
         (cipUrpfIfDropRate) meets or exceeds the value 
         specified by this object, a cipUrpfIfDropRateNotify 
         notification is sent if cipUrpfIfDropRateNotifyEnable 
         is set to true, and no such notification for the
         IP version has been sent for this interface for the 
         hold-down period.
        
         Note that due to the calculation used for drop rate, 
         if there are less than n drop events in an n-second
         period the notification will not be generated. To allow
         for the detection of a small number of drop events, the
         value 0 (zero) is used to indicate that if any drop events
         occur during the interval, a notification is generated."
		characteristics "-N cipUrpfIfNotifyDropRateThreshold -O 1.3.6.1.4.1.9.9.451.1.3.1.1.2 -T GAUGE -A RW -X equal -F 0"

		readwrite enum cipUrpfIfNotifyDrHoldDownResetE	cipUrpfIfNotifyDrHoldDownReset
		description 	"Setting this object to true causes the five-minute 
         hold-down timer for emitting URPF drop rate 
         notifications for IP version cipUrpfIfIpVersion on 
         the interface to be short-circuited.  If a notification 
         is due and would be emitted for the interface if the 
         five-minutes elapsed, setting this object will cause 
         the notification to be sent.
        
         This is a trigger, and doesn't hold information. It is
         set and an action is performed. Therefore a get for 
         this object always returns false."
		characteristics "-N cipUrpfIfNotifyDrHoldDownReset -O 1.3.6.1.4.1.9.9.451.1.3.1.1.3 -T INTEGER -A RW -X equal -F 0"

		readonly enum cipUrpfIfCheckStrictE	cipUrpfIfCheckStrict
		description 	"Interface configuration indicating the strictness of 
         the reachability check performed 
         on the interface.
         - strict: check that source addr is reachable via 
                   the interface it came in on.
         - loose : check that source addr is reachable via 
        some interface on the device."
		characteristics "-N cipUrpfIfCheckStrict -O 1.3.6.1.4.1.9.9.451.1.3.1.1.4 -T INTEGER -A RO -X equal -F 0"

		readonly enum cipUrpfIfWhichRouteTableIDE	cipUrpfIfWhichRouteTableID
		description 	"Interface configuration indicating the routing table 
         consulted for the reachability check:
         - default: the non-private routing table for of the 
                    managed system.
         - vrf   : a particular VPN routing table."
		characteristics "-N cipUrpfIfWhichRouteTableID -O 1.3.6.1.4.1.9.9.451.1.3.1.1.5 -T INTEGER -A RO -X equal -F 0"

		readonly octet[32]	cipUrpfIfVrfName
		description 	"If the value of cipUrpfIfWhichRouteTableID is 'vrf',
         the name of the VRF Table. Otherwise a zero-length
         string."
		characteristics "-N cipUrpfIfVrfName -O 1.3.6.1.4.1.9.9.451.1.3.1.1.6 -T STRING -A RO -X equal -F 0"

	)

	table	cipUrpfVrfTable
	description "This table enables indexing URPF drop statistics
         by Virtual Routing and Forwarding instances."
	characteristics "-K ???"
	(
		readonly octet[32]	cipUrpfVrfName
		description 	"This field is used to specify the VRF Table
         name."
		characteristics "-N cipUrpfVrfName -O 1.3.6.1.4.1.9.9.451.1.4.1.1.1 -T STRING -A RO -X equal -F 0"

	)

agenterrors (
	1	"cannot dispatch request"
	2	"select(2) failed"
	3	"sendto(2) failed"
	4	"recvfrom(2) failed"
	5	"no response from system"
	6	"response too big"
	7	"missing attribute"
	8	"bad attribute type"
	9	"cannot get sysUpTime"
	10	"sysUpTime type bad"
	11	"unknown SNMP error"
	12	"bad variable value"
	13	"variable is read only"
	14	"general error"
	15	"cannot make request PDU"
	16	"cannot make request varbind list"
	17	"cannot parse response PDU"
	18	"request ID - response ID mismatch"
	19	"string contains non-displayable characters"
	20	"cannot open schema file"
	21	"cannot parse schema file"
	22	"cannot open host file"
	23	"cannot parse host file"
	24	"attribute unavailable for set operations"
             )
)


## End of Agent Definitions
